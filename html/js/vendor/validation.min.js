/* jqBootstrapValidation
 * A plugin for automating validation on Twitter Bootstrap formatted forms.
 *
 * v1.3.6
 *
 * License: MIT <http://opensource.org/licenses/mit-license.php> - see LICENSE file
 *
 * http://ReactiveRaven.github.com/jqBootstrapValidation/
 */(function(e){function s(e){return new RegExp("^"+e+"$")}function o(e,t){var n=Array.prototype.slice.call(arguments).splice(2),r=e.split("."),i=r.pop();for(var s=0;s<r.length;s++)t=t[r[s]];return t[i].apply(this,n)}var t=[],n={options:{prependExistingHelpBlock:!1,sniffHtml:!0,preventSubmit:!0,submitError:!1,submitSuccess:!1,semanticallyStrict:!1,autoAdd:{helpBlocks:!0},filter:function(){return!0}},methods:{init:function(s){var o=e.extend(!0,{},n);o.options=e.extend(!0,o.options,s);var u=this,a=e.unique(u.map(function(){return e(this).parents("form")[0]}).toArray());e(a).bind("submit",function(t){var n=e(this),r=0,i=n.find("input,textarea,select").not("[type=submit],[type=image]").filter(o.options.filter);i.trigger("submit.validation").trigger("validationLostFocus.validation");i.each(function(t,n){var i=e(n),s=i.parents(".control-group").first();if(s.hasClass("warning")){s.removeClass("warning").addClass("error");r++}});i.trigger("validationLostFocus.validation");if(r){o.options.preventSubmit&&t.preventDefault();n.addClass("error");e.isFunction(o.options.submitError)&&o.options.submitError(n,t,i.jqBootstrapValidation("collectErrors",!0))}else{n.removeClass("error");e.isFunction(o.options.submitSuccess)&&o.options.submitSuccess(n,t)}});return this.each(function(){var n=e(this),s=n.parents(".control-group").first(),u=s.find(".help-block").first(),a=n.parents("form").first(),f=[];if(!u.length&&o.options.autoAdd&&o.options.autoAdd.helpBlocks){u=e('<div class="help-block" />');s.find(".controls").append(u);t.push(u[0])}if(o.options.sniffHtml){var l="";if(n.attr("pattern")!==undefined){l="Not in the expected format<!-- data-validation-pattern-message to override -->";n.data("validationPatternMessage")&&(l=n.data("validationPatternMessage"));n.data("validationPatternMessage",l);n.data("validationPatternRegex",n.attr("pattern"))}if(n.attr("max")!==undefined||n.attr("aria-valuemax")!==undefined){var c=n.attr("max")!==undefined?n.attr("max"):n.attr("aria-valuemax");l="Too high: Maximum of '"+c+"'<!-- data-validation-max-message to override -->";n.data("validationMaxMessage")&&(l=n.data("validationMaxMessage"));n.data("validationMaxMessage",l);n.data("validationMaxMax",c)}if(n.attr("min")!==undefined||n.attr("aria-valuemin")!==undefined){var h=n.attr("min")!==undefined?n.attr("min"):n.attr("aria-valuemin");l="Too low: Minimum of '"+h+"'<!-- data-validation-min-message to override -->";n.data("validationMinMessage")&&(l=n.data("validationMinMessage"));n.data("validationMinMessage",l);n.data("validationMinMin",h)}if(n.attr("maxlength")!==undefined){l="Too long: Maximum of '"+n.attr("maxlength")+"' characters<!-- data-validation-maxlength-message to override -->";n.data("validationMaxlengthMessage")&&(l=n.data("validationMaxlengthMessage"));n.data("validationMaxlengthMessage",l);n.data("validationMaxlengthMaxlength",n.attr("maxlength"))}if(n.attr("minlength")!==undefined){l="Too short: Minimum of '"+n.attr("minlength")+"' characters<!-- data-validation-minlength-message to override -->";n.data("validationMinlengthMessage")&&(l=n.data("validationMinlengthMessage"));n.data("validationMinlengthMessage",l);n.data("validationMinlengthMinlength",n.attr("minlength"))}if(n.attr("required")!==undefined||n.attr("aria-required")!==undefined){l=o.builtInValidators.required.message;n.data("validationRequiredMessage")&&(l=n.data("validationRequiredMessage"));n.data("validationRequiredMessage",l)}if(n.attr("type")!==undefined&&n.attr("type").toLowerCase()==="number"){l=o.builtInValidators.number.message;n.data("validationNumberMessage")&&(l=n.data("validationNumberMessage"));n.data("validationNumberMessage",l)}if(n.attr("type")!==undefined&&n.attr("type").toLowerCase()==="email"){l="Not a valid email address<!-- data-validator-validemail-message to override -->";n.data("validationValidemailMessage")?l=n.data("validationValidemailMessage"):n.data("validationEmailMessage")&&(l=n.data("validationEmailMessage"));n.data("validationValidemailMessage",l)}if(n.attr("minchecked")!==undefined){l="Not enough options checked; Minimum of '"+n.attr("minchecked")+"' required<!-- data-validation-minchecked-message to override -->";n.data("validationMincheckedMessage")&&(l=n.data("validationMincheckedMessage"));n.data("validationMincheckedMessage",l);n.data("validationMincheckedMinchecked",n.attr("minchecked"))}if(n.attr("maxchecked")!==undefined){l="Too many options checked; Maximum of '"+n.attr("maxchecked")+"' required<!-- data-validation-maxchecked-message to override -->";n.data("validationMaxcheckedMessage")&&(l=n.data("validationMaxcheckedMessage"));n.data("validationMaxcheckedMessage",l);n.data("validationMaxcheckedMaxchecked",n.attr("maxchecked"))}}n.data("validation")!==undefined&&(f=n.data("validation").split(","));e.each(n.data(),function(e,t){var n=e.replace(/([A-Z])/g,",$1").split(",");n[0]==="validation"&&n[1]&&f.push(n[1])});var p=f,d=[];do{e.each(f,function(e,t){f[e]=r(t)});f=e.unique(f);d=[];e.each(p,function(t,i){if(n.data("validation"+i+"Shortcut")!==undefined)e.each(n.data("validation"+i+"Shortcut").split(","),function(e,t){d.push(t)});else if(o.builtInValidators[i.toLowerCase()]){var s=o.builtInValidators[i.toLowerCase()];s.type.toLowerCase()==="shortcut"&&e.each(s.shortcut.split(","),function(e,t){t=r(t);d.push(t);f.push(t)})}});p=d}while(p.length>0);var v={};e.each(f,function(t,i){var s=n.data("validation"+i+"Message"),u=s!==undefined,a=!1;s=s?s:"'"+i+"' validation failed <!-- Add attribute 'data-validation-"+i.toLowerCase()+"-message' to input to change this message -->";e.each(o.validatorTypes,function(t,o){v[t]===undefined&&(v[t]=[]);if(!a&&n.data("validation"+i+r(o.name))!==undefined){v[t].push(e.extend(!0,{name:r(o.name),message:s},o.init(n,i)));a=!0}});if(!a&&o.builtInValidators[i.toLowerCase()]){var f=e.extend(!0,{},o.builtInValidators[i.toLowerCase()]);u&&(f.message=s);var l=f.type.toLowerCase();l==="shortcut"?a=!0:e.each(o.validatorTypes,function(t,s){v[t]===undefined&&(v[t]=[]);if(!a&&l===t.toLowerCase()){n.data("validation"+i+r(s.name),f[s.name.toLowerCase()]);v[l].push(e.extend(f,s.init(n,i)));a=!0}})}a||e.error("Cannot find validation info for '"+i+"'")});u.data("original-contents",u.data("original-contents")?u.data("original-contents"):u.html());u.data("original-role",u.data("original-role")?u.data("original-role"):u.attr("role"));s.data("original-classes",s.data("original-clases")?s.data("original-classes"):s.attr("class"));n.data("original-aria-invalid",n.data("original-aria-invalid")?n.data("original-aria-invalid"):n.attr("aria-invalid"));n.bind("validation.validation",function(t,r){var s=i(n),u=[];e.each(v,function(t,i){(s||s.length||r&&r.includeEmpty||!!o.validatorTypes[t].blockSubmit&&r&&!!r.submitting)&&e.each(i,function(e,r){o.validatorTypes[t].validate(n,s,r)&&u.push(r.message)})});return u});n.bind("getValidators.validation",function(){return v});n.bind("submit.validation",function(){return n.triggerHandler("change.validation",{submitting:!0})});n.bind(["keyup","focus","blur","click","keydown","keypress","change"].join(".validation ")+".validation",function(t,r){var f=i(n),l=[];s.find("input,textarea,select").each(function(t,i){var s=l.length;e.each(e(i).triggerHandler("validation.validation",r),function(e,t){l.push(t)});if(l.length>s)e(i).attr("aria-invalid","true");else{var o=n.data("original-aria-invalid");e(i).attr("aria-invalid",o!==undefined?o:!1)}});a.find("input,select,textarea").not(n).not('[name="'+n.attr("name")+'"]').trigger("validationLostFocus.validation");l=e.unique(l.sort());if(l.length){s.removeClass("success error").addClass("warning");o.options.semanticallyStrict&&l.length===1?u.html(l[0]+(o.options.prependExistingHelpBlock?u.data("original-contents"):"")):u.html('<ul role="alert"><li>'+l.join("</li><li>")+"</li></ul>"+(o.options.prependExistingHelpBlock?u.data("original-contents"):""))}else{s.removeClass("warning error success");f.length>0&&s.addClass("success");u.html(u.data("original-contents"))}t.type==="blur"&&s.removeClass("success")});n.bind("validationLostFocus.validation",function(){s.removeClass("success")})})},destroy:function(){return this.each(function(){var n=e(this),r=n.parents(".control-group").first(),i=r.find(".help-block").first();n.unbind(".validation");i.html(i.data("original-contents"));r.attr("class",r.data("original-classes"));n.attr("aria-invalid",n.data("original-aria-invalid"));i.attr("role",n.data("original-role"));t.indexOf(i[0])>-1&&i.remove()})},collectErrors:function(t){var n={};this.each(function(t,r){var i=e(r),s=i.attr("name"),o=i.triggerHandler("validation.validation",{includeEmpty:!0});n[s]=e.extend(!0,o,n[s])});e.each(n,function(e,t){t.length===0&&delete n[e]});return n},hasErrors:function(){var t=[];this.each(function(n,r){t=t.concat(e(r).triggerHandler("getValidators.validation")?e(r).triggerHandler("validation.validation",{submitting:!0}):[])});return t.length>0},override:function(t){n=e.extend(!0,n,t)}},validatorTypes:{callback:{name:"callback",init:function(e,t){return{validatorName:t,callback:e.data("validation"+t+"Callback"),lastValue:e.val(),lastValid:!0,lastFinished:!0}},validate:function(e,t,n){if(n.lastValue===t&&n.lastFinished)return!n.lastValid;if(n.lastFinished===!0){n.lastValue=t;n.lastValid=!0;n.lastFinished=!1;var r=n,i=e;o(n.callback,window,e,t,function(e){if(r.lastValue===e.value){r.lastValid=e.valid;e.message&&(r.message=e.message);r.lastFinished=!0;i.data("validation"+r.validatorName+"Message",r.message);setTimeout(function(){i.trigger("change.validation")},1)}})}return!1}},ajax:{name:"ajax",init:function(e,t){return{validatorName:t,url:e.data("validation"+t+"Ajax"),lastValue:e.val(),lastValid:!0,lastFinished:!0}},validate:function(t,n,r){if(""+r.lastValue==""+n&&r.lastFinished===!0)return r.lastValid===!1;if(r.lastFinished===!0){r.lastValue=n;r.lastValid=!0;r.lastFinished=!1;e.ajax({url:r.url,data:"value="+n+"&field="+t.attr("name"),dataType:"json",success:function(e){if(""+r.lastValue==""+e.value){r.lastValid=!!e.valid;e.message&&(r.message=e.message);r.lastFinished=!0;t.data("validation"+r.validatorName+"Message",r.message);setTimeout(function(){t.trigger("change.validation")},1)}},failure:function(){r.lastValid=!0;r.message="ajax call failed";r.lastFinished=!0;t.data("validation"+r.validatorName+"Message",r.message);setTimeout(function(){t.trigger("change.validation")},1)}})}return!1}},regex:{name:"regex",init:function(e,t){return{regex:s(e.data("validation"+t+"Regex"))}},validate:function(e,t,n){return!n.regex.test(t)&&!n.negative||n.regex.test(t)&&n.negative}},required:{name:"required",init:function(e,t){return{}},validate:function(e,t,n){return t.length===0&&!n.negative||!!(t.length>0&&n.negative)},blockSubmit:!0},match:{name:"match",init:function(e,t){var n=e.parents("form").first().find('[name="'+e.data("validation"+t+"Match")+'"]').first();n.bind("validation.validation",function(){e.trigger("change.validation",{submitting:!0})});return{element:n}},validate:function(e,t,n){return t!==n.element.val()&&!n.negative||t===n.element.val()&&n.negative},blockSubmit:!0},max:{name:"max",init:function(e,t){return{max:e.data("validation"+t+"Max")}},validate:function(e,t,n){return parseFloat(t,10)>parseFloat(n.max,10)&&!n.negative||parseFloat(t,10)<=parseFloat(n.max,10)&&n.negative}},min:{name:"min",init:function(e,t){return{min:e.data("validation"+t+"Min")}},validate:function(e,t,n){return parseFloat(t)<parseFloat(n.min)&&!n.negative||parseFloat(t)>=parseFloat(n.min)&&n.negative}},maxlength:{name:"maxlength",init:function(e,t){return{maxlength:e.data("validation"+t+"Maxlength")}},validate:function(e,t,n){return t.length>n.maxlength&&!n.negative||t.length<=n.maxlength&&n.negative}},minlength:{name:"minlength",init:function(e,t){return{minlength:e.data("validation"+t+"Minlength")}},validate:function(e,t,n){return t.length<n.minlength&&!n.negative||t.length>=n.minlength&&n.negative}},maxchecked:{name:"maxchecked",init:function(e,t){var n=e.parents("form").first().find('[name="'+e.attr("name")+'"]');n.bind("click.validation",function(){e.trigger("change.validation",{includeEmpty:!0})});return{maxchecked:e.data("validation"+t+"Maxchecked"),elements:n}},validate:function(e,t,n){return n.elements.filter(":checked").length>n.maxchecked&&!n.negative||n.elements.filter(":checked").length<=n.maxchecked&&n.negative},blockSubmit:!0},minchecked:{name:"minchecked",init:function(e,t){var n=e.parents("form").first().find('[name="'+e.attr("name")+'"]');n.bind("click.validation",function(){e.trigger("change.validation",{includeEmpty:!0})});return{minchecked:e.data("validation"+t+"Minchecked"),elements:n}},validate:function(e,t,n){return n.elements.filter(":checked").length<n.minchecked&&!n.negative||n.elements.filter(":checked").length>=n.minchecked&&n.negative},blockSubmit:!0}},builtInValidators:{email:{name:"Email",type:"shortcut",shortcut:"validemail"},validemail:{name:"Validemail",type:"regex",regex:"[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,4}",message:"Not a valid email address<!-- data-validator-validemail-message to override -->"},passwordagain:{name:"Passwordagain",type:"match",match:"password",message:"Does not match the given password<!-- data-validator-paswordagain-message to override -->"},positive:{name:"Positive",type:"shortcut",shortcut:"number,positivenumber"},negative:{name:"Negative",type:"shortcut",shortcut:"number,negativenumber"},number:{name:"Number",type:"regex",regex:"([+-]?\\d+(\\.\\d*)?([eE][+-]?[0-9]+)?)?",message:"Must be a number<!-- data-validator-number-message to override -->"},integer:{name:"Integer",type:"regex",regex:"[+-]?\\d+",message:"No decimal places allowed<!-- data-validator-integer-message to override -->"},positivenumber:{name:"Positivenumber",type:"min",min:0,message:"Must be a positive number<!-- data-validator-positivenumber-message to override -->"},negativenumber:{name:"Negativenumber",type:"max",max:0,message:"Must be a negative number<!-- data-validator-negativenumber-message to override -->"},required:{name:"Required",type:"required",message:"This is required<!-- data-validator-required-message to override -->"},checkone:{name:"Checkone",type:"minchecked",minchecked:1,message:"Check at least one option<!-- data-validation-checkone-message to override -->"}}},r=function(e){return e.toLowerCase().replace(/(^|\s)([a-z])/g,function(e,t,n){return t+n.toUpperCase()})},i=function(t){var n=t.val(),r=t.attr("type");r==="checkbox"&&(n=t.is(":checked")?n:"");r==="radio"&&(n=e('input[name="'+t.attr("name")+'"]:checked').length>0?n:"");return n};e.fn.jqBootstrapValidation=function(t){if(n.methods[t])return n.methods[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t=="object"||!t)return n.methods.init.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.jqBootstrapValidation");return null};e.jqBootstrapValidation=function(t){e(":input").not("[type=image],[type=submit]").jqBootstrapValidation.apply(this,arguments)}})(jQuery);